---
title: 【Claude Code】スキル・プロンプト・MCP・サブエージェントを使い分ける
emoji: 🎯
type: tech
topics:
  - claude
  - ai
  - claudecode
published: false
---

:::message
この記事はClaude Skills、SubAgentの検証のため、AIと人力で書きました。
:::

こんにちは、noguです。

## はじめに

**この記事の対象読者**
- Claude Codeを使い始めたが、機能が多すぎて使い方を迷っている方
- スキル、プロンプト、MCP、サブエージェントの違いがよくわからない方
- 「この機能はどれを使えばいいんだろう？」と毎回悩んでいる方

**この記事でわかること**
- スキル、プロンプト、MCP、サブエージェントそれぞれの役割と仕組み
- どの機能をいつ使うべきかの判断基準

**この記事で扱わないこと**
- 各機能の詳細な実装方法やコーディング
- Claude Code自体のインストールや基本的な使い方
- Claudeモデルの内部アーキテクチャ

この記事を最後まで読むことで、Claude Codeの機能を適材適所で使い分けられるようになり、「これはスキルにすべきか、プロンプトで十分か」という迷いから解放されます。
## Claude Codeの4つの武器：全体像

Claude Codeには、異なる目的に特化した4つの機能があります。

ここに図を挿入

```
┌─────────────────────────────────────────────────────────┐
│ Claude Codeの機能マップ                                    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  💬 プロンプト      ──→  その場の指示                      │
│  🎯 スキル         ──→  再利用可能な専門知識                │
│  🔌 MCP           ──→  外部システムへの接続                │
│  🤖 サブエージェント  ──→  独立したタスク実行                │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

それぞれの機能を深く理解する前に、まずは「何を提供するか」という観点で整理しましょう。

## スキル：再利用可能な専門知識

スキルとは、**Claudeが動的に読み込む指示、スクリプト、リソースを含むフォルダ**です。専門的なトレーニングマニュアルのようなものと考えてください。

Claudeはタスクに遭遇すると、利用可能なスキルをスキャンして関連するスキルを探します。スキルが見つかると、そのスキルの内容を段階的に読み込んで専門知識を獲得します。

同じ説明を何度も繰り返すのは、非効率的です。スキルを使えば、以下のメリットがあります。

- **一貫性**: 毎回同じ手順や基準が適用される
- **効率性**: 説明を繰り返す必要がなく、トークンを節約できる
- **専門性**: 複雑なワークフローやドメイン知識を確実に適用できる

スキルは**段階的開示（Progressive Disclosure）**という仕組みで動作します。

```
レベル1: メタデータ（常時読み込み）
  ↓ name: "pdf-processing"
  ↓ description: "PDFファイルからテキストを抽出..."
  ↓ トークンコスト: 約100トークン

レベル2: 指示（トリガー時に読み込み）
  ↓ SKILL.mdの本文を読み込む
  ↓ トークンコスト: 5,000トークン未満

レベル3: リソース（必要に応じて読み込み）
  ↓ 参照ファイルやスクリプトを実行
  ↓ トークンコスト: 事実上無制限（ファイルシステム経由）
```

この仕組みにより、多数のスキルをインストールしてもコンテキストウィンドウを圧迫しません。

**スキルの基本構造**

```
brand-guidelines/
├── SKILL.md              # メイン指示（YAMLフロントマター付き）
├── color-palette.md      # カラーパレット詳細
├── typography.md         # タイポグラフィルール
└── examples/
    └── template.pptx     # 使用例
```

`SKILL.md`のフロントマター例：

```yaml
---
name: brand-guidelines
description: 会社のブランドガイドラインに従ってドキュメントとプレゼンテーションを作成します。デザイン作業やドキュメント作成時に使用します。
---

# ブランドガイドライン

## カラーパレット
プライマリカラー: #3B82F6
セカンダリカラー: #10B981

詳細は [color-palette.md](color-palette.md) を参照してください。

## タイポグラフィ
見出し: Poppins
本文: Inter

詳細は [typography.md](typography.md) を参照してください。
```

Claudeがプレゼンテーション作成を依頼されると、このスキルを自動的に発見し、`SKILL.md`を読み込んで、必要に応じて`color-palette.md`や`typography.md`も参照します。

**スキルを使うべきタイミング**

- 同じプロンプトを3回以上入力したとき
- 組織のワークフローやベストプラクティスを標準化したいとき
- 専門的な知識（Excel数式、データ分析パターンなど）が必要なとき

## プロンプト：その場の指示

プロンプトとは、**会話中にClaudeに自然言語で伝える指示**のことです。一時的、会話的、かつ反応的なものです。

プロンプトは、その場その場のニーズに柔軟に対応できます。スキルやその他の機能が「事前準備された知識」だとすれば、プロンプトは「リアルタイムの会話」です。

プロンプトは会話の中で直接入力します。

```
悪い例：
「セキュリティレビューして」
→ 曖昧で、何を基準にレビューすべきか不明確

良い例：
「このコードの包括的なセキュリティレビューを実施してください。
OWASP Top 10の脆弱性を中心に、以下を確認してください：
- SQLインジェクション
- XSS（クロスサイトスクリプティング）
- 認証・認可の問題
各問題に対して、重大度レベルと修正推奨を提示してください。」
```

**プロンプトを使うべきタイミング**

- 単発のリクエスト（「この記事を要約してください」）
- 会話の洗練（「よりプロフェッショナルな口調にしましょう」）
- 即時のコンテキスト（「このデータを分析して傾向を特定する」）

**重要な判断基準**: 同じプロンプトを繰り返し入力している場合、それはスキルに変換すべきサインです。

## サブエージェント

サブエージェントとは、**独自のコンテキストウィンドウ、カスタムシステムプロンプト、特定のツール権限を備えた専門AIアシスタント**です。独立したタスクを処理し、結果をメインエージェントに返します。

複雑なワークフローでは、異なるツール権限や専門的なロジックを持つ独立したエージェントが必要になることがあります。

- **コンテキスト管理**: メインの会話を保ちながら、専門作業をオフロード
- **ツールの制限**: 特定のサブエージェントを安全な操作に制限（例: 読み取り専用）
- **並列処理**: 複数のサブエージェントが異なる側面を同時に処理

サブエージェントは`.claude/agents/`ディレクトリに定義します。

**例: コードレビュー専用サブエージェント**

```yaml
# .claude/agents/code-reviewer.yaml
name: code-reviewer
description: コードの品質とセキュリティをレビューします。コード変更後に使用してください。
tools:
  - Read
  - Grep
  - Glob
# Write や Edit は含めない（読み取り専用）
---
あなたはコードレビューの専門家です。

レビュー時は以下を確認してください：
1. コード構造と設計パターン
2. セキュリティ脆弱性（OWASP Top 10）
3. パフォーマンス問題
4. 可読性と保守性

各問題に対して重大度レベルと修正提案を提示してください。
```

Claudeはコード変更時に、自動的にこのサブエージェントにレビューを委任できます。

**サブエージェントを使うべきタイミング**

- 特定のツール権限が必要なとき（読み取り専用、書き込み専用など）
- 独立したコンテキストで処理したいとき
- 並列処理が必要なとき

## MCP（Model Context Protocol）：外部システムへの接続

MCPとは、**AIアシスタントを外部システムに接続するためのオープンスタンダード**です。Claudeをデータソース、ビジネスツール、開発環境に接続します。

Claudeは強力ですが、単体では外部のデータにアクセスできません。MCPは、Claudeを「閉じた箱」から「接続されたエコシステム」に変えます。

- Google Driveのドキュメントにアクセス
- Slackのメッセージを検索
- データベースをクエリ
- GitHubのコードを参照

MCPは、**MCPサーバー**（データやツールを公開）と**MCPクライアント**（Claudeなど）の間の標準プロトコルです。

```
┌──────────────┐
│   Claude     │ ← MCPクライアント
└──────┬───────┘
       │ MCP Protocol
       │
       ├──→ Google Drive Server
       ├──→ Database Server
       └──→ Slack Server
```

Claude Code settings（`.claude/settings.json`）でMCPサーバーを設定：

```json
{
  "mcpServers": {
    "google-drive": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-gdrive"]
    }
  }
}
```

**MCPを使うべきタイミング**

- 外部データへのアクセスが必要なとき
- ビジネスツール（CRM、プロジェクト管理）を使いたいとき
- ローカルファイルシステムやデータベースに接続したいとき

## 使い分けの決定木：迷ったときの判断フロー

どの機能を使うべきか迷ったときは、この決定木を使ってください。

```
┌─────────────────────────────────────┐
│ Claudeに何かさせたい                   │
└────────────┬────────────────────────┘
             │
             ▼
     ┌───────────────┐
     │ 外部データへの │
     │ アクセスが必要？│
     └───┬───────┬───┘
         │Yes    │No
         │       │
         ▼       ▼
      【MCP】  ┌──────────────┐
              │ 独立したタスク  │
              │ 実行が必要？   │
              └───┬──────┬───┘
                  │Yes   │No
                  │      │
                  ▼      ▼
            【サブエージェント】
                       ┌────────────┐
                       │ 同じ説明を  │
                       │ 繰り返す？  │
                       └───┬────┬──┘
                           │Yes │No
                           │    │
                           ▼    ▼
                        【スキル】【プロンプト】
```

## 比較表：一目でわかる違い

| 特徴 | スキル | プロンプト | MCP | サブエージェント |
|------|--------|-----------|-----|----------------|
| **提供するもの** | 手続き的知識 | その場の指示 | ツールの接続性 | タスクの委任 |
| **持続性** | 会話をまたいで持続 | 単一の会話のみ | 継続的な接続 | セッション全体 |
| **含まれるもの** | 指示+コード+アセット | 自然言語 | ツール定義 | 完全なエージェントロジック |
| **読み込まれるタイミング** | 必要に応じて動的に | 各ターンごと | いつでも利用可能 | 呼び出されたとき |
| **コードを含められるか** | はい | いいえ | はい | はい |
| **最適な用途** | 専門知識の再利用 | クイックリクエスト | データアクセス | 専門的なタスク |
| **トークンコスト** | 低〜中（段階的） | 中〜高（毎回） | 低（接続のみ） | 独立したコンテキスト |

## 実践例：調査エージェントの構築

これらの機能を組み合わせて、競合分析用の調査エージェントを構築してみましょう。

### ステップ1: MCPで外部データに接続

```json
// .claude/settings.json
{
  "mcpServers": {
    "google-drive": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-gdrive"]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"]
    }
  }
}
```

これで、Claudeは会社のGoogle Drive内のリサーチドキュメントや、競合他社のGitHubリポジトリにアクセスできるようになります。

### ステップ2: スキルで分析フレームワークを提供

```yaml
# .claude/skills/competitive-analysis/SKILL.md
---
name: competitive-analysis
description: 競合他社を分析し、差別化機会と市場トレンドに焦点を当てます。競合分析タスクで使用します。
---

# 競合分析フレームワーク

## 分析の5つの軸

1. **製品機能**: 何を提供しているか
2. **ターゲット市場**: 誰をターゲットにしているか
3. **価格戦略**: どのように価格設定しているか
4. **技術スタック**: どんな技術を使っているか
5. **市場ポジショニング**: どのように差別化しているか

## レポート形式

分析結果は以下の形式で提示：

- **エグゼクティブサマリー**: 3-5行
- **主要な発見**: 箇条書き
- **差別化の機会**: 具体的な推奨事項
- **次のステップ**: 実行可能なアクション
```

### ステップ3: サブエージェントで専門タスクを分離

```yaml
# .claude/agents/market-researcher.yaml
name: market-researcher
description: 市場トレンド、業界レポート、競合状況を調査します。競合分析で自動的に使用されます。
tools:
  - Read
  - Grep
  - WebSearch
---
あなたは市場調査アナリストです。

調査時は以下を実施：
1. 権威ある情報源を特定（Gartner、Forrester、業界レポート）
2. 定量データを収集（市場シェア、成長率、資金調達）
3. 定性的インサイトを分析（アナリスト意見、顧客レビュー）
4. トレンドとパターンを統合

発見事項は引用と信頼度レベルを付けて提示してください。
```

### ステップ4: プロンプトで具体的な指示を出す

```
「トップ3の競合他社が新しいAI機能をどのように位置付けているかを分析し、
私たちが活用できるギャップを特定してください。
特に医療分野のエンタープライズ顧客に焦点を当てます。」
```

### 実行の流れ

1. **MCP接続がアクティブ化**: Claudeは自動的にGoogle DriveやGitHubからデータを取得
2. **スキルが適用**: 競合分析スキルの5つの軸フレームワークが適用される
3. **サブエージェントが実行**: market-researcherが市場データを収集
4. **プロンプトで絞り込み**: 「医療分野のエンタープライズ顧客」という具体的な焦点を提供

結果として、複数のデータソースから情報を統合し、一貫したフレームワークで分析し、具体的な推奨事項を提供する包括的なレポートが得られます。

## よくある間違いと解決策

### 間違い1: すべてをプロンプトで解決しようとする

**症状**: 毎回同じ長いプロンプトをコピペしている

**解決策**: 繰り返し使うプロンプトはスキルに変換する

### 間違い2: すべてをスキルにしようとする

**症状**: 一度しか使わない指示をスキル化している

**解決策**: 3回以上使うまではプロンプトのまま。本当に再利用するかを見極める

### 間違い3: MCPとスキルを混同する

**症状**: 「データベースにアクセスするスキルを作ろうとしている」

**解決策**:
- データベース**接続**はMCP
- データベース**クエリのベストプラクティス**はスキル

### 間違い4: サブエージェントの過剰使用

**症状**: シンプルなタスクにもサブエージェントを作成している

**解決策**: サブエージェントは独立したコンテキストやツール制限が必要なときのみ使用

## おわりに

Claude Codeの4つの機能—スキル、プロンプト、MCP、サブエージェント—は、それぞれ異なる問題を解決するために設計されています。

**覚えておくべき原則**：

- **プロンプト**: その場の会話で十分なとき
- **スキル**: 繰り返し使う知識や手順があるとき
- **MCP**: 外部データやツールへの接続が必要なとき
- **サブエージェント**: 独立したタスク実行やツール制限が必要なとき

### 今すぐ始めるには

1. 自分が繰り返し入力しているプロンプトを洗い出す
2. 3回以上使っているものをスキルに変換する
3. 外部データアクセスが必要な場合はMCPサーバーを検討する
4. 複雑なワークフローにはサブエージェントの導入を検討する

### 次のステップ

- [Claude Code公式ドキュメント](https://code.claude.com/docs)でスキルの作成方法を学ぶ
- [MCP公式サイト](https://modelcontextprotocol.io/)で利用可能なMCPサーバーを探す
- 自分のワークフローに合わせてカスタムスキルを作成する

---

この記事が役に立ったら、Xをフォローしていただけると嬉しいです！

https://x.com/_nogu66

## 参考リンク

- [Claude Skills公式ブログ](https://claude.com/blog/skills-explained)
- [Claude Code公式ドキュメント](https://code.claude.com/docs)
- [Model Context Protocol](https://modelcontextprotocol.io/)
- [Agent Skills概要](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/overview)
- [Anthropic - Equipping agents for the real world with Agent Skills](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)
